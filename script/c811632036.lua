--Token Efforts
Duel.LoadScript("wb_aux.lua")

local s,id=GetID()
function s.initial_effect(c)
	--Activate Skill
	aux.AddSkillProcedure(c,2,false,nil,nil)
	local e1=Effect.CreateEffect(c)
	e1:SetProperty(EFFECT_FLAG_UNCOPYABLE+EFFECT_FLAG_CANNOT_DISABLE)
	e1:SetType(EFFECT_TYPE_FIELD+EFFECT_TYPE_CONTINUOUS)
	e1:SetCode(EVENT_STARTUP)
	e1:SetCountLimit(1)
	e1:SetRange(0x5f)
	e1:SetLabel(0)
	e1:SetOperation(s.op)
	c:RegisterEffect(e1)
end


local levels={}
levels[1]={30221870,68140974,31930787,16024176,35405755,14957440,45663742,13582837,9674034,58786132,95457011,99594764,74762582,13761956,7540107,14169843,90241276,74289646,38562933,81846636,57421866,32176662,38783169,81570454,93665266,25533642,54126514,81962318,40177746,56824871,90681088,91479482,9742784,81951640,82744076,11747708,73652465,75886890,84899094,34206604,36472900,56570271,85401123,85101097,8131171,7489323,7021574,33245030,34419588,38491199,44632120,46613515,46789706,47432275,50185950,57116034,71036835,84133008,85255550,97651498,13599884,11760174,83991690,1142880,30492798,83094004,39643167,76218643,93169863,92676637,16001119,93369354,96782886,98024118,2830693,11548522,12538374,13478040,24508238,56364287,57769391,64591429,67441435,71583486,81752019,85457355,86784733,94878265,96146814,7930346,53266486,12058741,18789533,29719112,14816857,20318029,90179822,4632019,40380686,51275027,3657444,4545683,5592689,6205579,7268133,7969770,8972398,11021521,14198496,15610297,26376390,31034919,43803845,48343627,48868994,50366775,52254878,60990740,70410002,71521025,72992744,78642798,79491903,79538761,97631303,97637162,98022050,64631466,76815942,77693536,26973555,33909817,1174075,60181553,4019153,15232745,42230449,78625448,46895036,12533811,55935416,48928529,69058960,95442074,84124261,58058134,54366836,89642993,7020743,8491961,19369609,27240101,29085954,43490025,48608796,57314798,65305468,72971064}
levels[2]={49928686,36750412,36107810,75922381,50810455,48519867,89928517,90311614,63948258,59575539,27491571,46128076,81383947,2311090,27971137,41952656,86993168,9126351,23168060,9396662,39829561,1281505,9097866,47507260,74078255,61807040,22404675,59463312,90724272,9861795,23571046,19113101,28139785,53855409,15839054,27416701,69529567,25716180,7721912,50823978,59563768,48017189,55702233,90020780,56196385,7805147,82090807,82593786,46291010,16229315,72291078,28470714,95504778,68658728,46657337,40975574,8201910,80741828,12061457,13171876,94076521,39732186,30968774,16222645,67629977,70744296,71625222,92919429,23434538,23379054,69750546,23893227,24096499,28388927,56052205,55063681,52253888,67694706,564541,33420078,2992467,81816475,1980574,25034083,2732323,8687195,88753985,58680635,93683815,42427230,21502796,83550869,85914562,1357146,21893603,46239604,47346782,58475908,46710683,87685879,52430902,30765615,56840658,47028805,42517468,62125438,58518520,53154400,3248469,10807219,25592142,73413514,74983881,76722334,78905039,51196174,10960419,55990317,32480825,92744676,37038993,17994645,62560742,50091196,25472513,61307542,29208536,90809975,79747096,54191698,53054164,52645235,36776089,9486959,54498517,98049934,97170107,12219047,2766877,76833149,39972129,62592805,3790062,1249315,30439101,10002346,84224627,50789693,24434049,55727845,37649320,32453837,56051086}
levels[3]={23898021,39931513,19299793,92597893,35199656,25795273,65326118,26857786,38742075,79875526,30227494,77428945,9637706,11954712,83239739,90508760,90243945,8736823,36717258,43586926,46609443,57568840,66104644,43502497,45010690,89015998,33145233,29834183,41386308,6901008,44640691,56223084,70298454,81035362,42874792,64257161,80335817,79853073,47840168,52090844,2009101,54485355,27868563,42463414,49959355,39041550,39078434,55705473,15394083,22371016,52860176,26439287,15308295,39354437,15717011,52101615,88696724,10809984,77379481,93445074,26293219,15150365,26202165,41872150,43237273,88032368,11685347,50915474,67959180,92559258,97682931,4334811,80344569,87462901,9817927,1799464,48386462,57624336,59808784,79169622,32787239,3233859,61681816,66451379,83819309,48686504,79109599,15383415,19280589,86952477,71736213,83903521,26701483,42256406,85087012,4141820,66436257,17732278,15341821,36629635,20228463,59438930,74879881,36584821,50599453,45001322,99185129,89016236,99414168,92385016,55863245,46057733,25200959,81846453,15240238,13574687,56292140,19891310,94151981,61641818,40424929,93730230,74416224,80993256,31320433,47506081,62709239,69610924,71068247,47579719,51497409,85252081,91895091,14306092,47805931,75367227,95992081,68836428,3989465,12615446,31539614,15914410,1426714,52558805,84401683,49195710,78156759,26563200,88942504,57043117,71166481,90098780,83531441,90664857,16259549,32003339}
levels[4]={23771716,100432032,51351302,30012506,12694768,89718302,70832512,49771608,44179224,24907044,65477143,51028231,7279373,51391183,18318842,88409165,44223284,11302671,10286023,47897376,74891384,45236142,71620241,72843899,16135253,62320425,86377375,69023354,78121572,86120751,43096270,62315111,38468214,64160836,97127906,25920413,58066722,91070115,98719226,64428736,25771826,76650663,55982698,85876417,92998610,99785935,85673903,53143898,27632240,62962630,27024795,32181268,22662014,67314110,17968114,91869203,29654737,55821894,47480070,53162898,94004268,89567993,64342551,58324930,38520918,93221206,60953949,18486927,17663375,43230671,36821538,6438003,13923256,77539547,40140448,40428851,87979586,43583400,41098335,41158734,96427353,85639257,40916023,22377815,16889337,8396952,35781051,61175706,97574404,34568403,92039899,48675364,14430063,49881766,40502912,75730490,1225009,56827051,36151751,28985331,75220074,84430950,20470500,7180418,86915847,67159705,15480588,17535588,17170970,29687169,85489096,7913375,3431737,72714226,77036039,39015,29311166,69852487,2134346,74311226,70089580,29139104,84914462,48305365,42969214,75081613,77411244,8567955,39892082,86325596,10476868,84478195,19740112,46145256,73356503,60549248,47346845,44586426,48094997,5053103,64178868,69695704,90161770,100432033,5361647,79867938,100432034,35537251,32750341,68144350,100432032,13313278,40133511,84990171,21362970,16796157,99426834,46924949,16899564,32452818,58400390,30587695,51578214,6628343,94022093,33731070,39168895,39256679,58685438,32696942,16768387,53606874,74130411,75252099,45547649,36694815,50896944,61901281,75672051,79409334,52319752,91642007,87564352,17465972,49003716,88305978,19462747,41902352,81105204,8571567,58820853,70465810,73534250,14785765,70194827,39507162,97023549,21051146,26302522,16984449,95515789,92518817,5464695,35215622,61802346,43694481,50920465,34743446,48115277,97783659,55969226,50903514,54582424,98884569,14089428,7953868,41396436,55349375,40634253,21340051,37675138,938717,13316346,20546916,32296881,61156777,45025640,74277583,78161361,66740005,71413901,52840598,16719802,27217742,6353603,66762372,92572371,93751476,43748308,98093548,70355994,66084673,75132317,6214884,36569343,23979249,70026064,9418365,92586237,53678698,29981935,32339440,42551040,88940154,68601507,89662736,23857661,59251766,16157341,94096616,10860121,50474354,69723159,11958188,56574543,86868952,5818294,80555062,32202803,59364406,4998619,7150545,3405259,91449144,74440055,5244497,11384280,16021142,55289183,4694209,46848859,62121,54360049,61245403,93220472,54092240,45531624,91152256,96930127,88190453,77252217,32600024,18859369,66699781,53871273,30327674,47829960,49191560,16956455,7198399,95905259,54878729,94766498,20154092,52158283,88552992,97112505,67559101,24861088,2089016,50916353,58383100,21999001,81974607,98234196,87468732,21830679,17810268,79703905,43318266,13474291,16197610,42541548,3534077,94395649,65496056,75130221,8662794,24661486,54656181,8806072,10375182,22666164,68018709,44656450,43513897,41269771,82913020,70908596,78364470,78358521,101201005,93889755,38289717,53713014,28358902,74976215,64806765,9505425,73853830,54525057,81524756,69937550,21698716,7093411,95600067,14469229,55326322,10789972,69526976,85802526,59907935,59281922,29975188,5373478,91663373,30655537,76763417,80316585,3370104,39978267,75559356,5370235,77625948,41230939,3019642,96428622,645087,36033786,51020079,34614910,81057959,70074904,44792253,52702748,48092532,95291684,37043180,7572887,36614113,19808608,39153655,55415564,28406301,12822541,72181263,46796664,59546528,90925163,16209941,52350806,41949033,11321183,57784563,33875961,91596726,62312469,81755371,21417692,88685329,14536035,26914168,19357125,90980792,85313220,99261403,74153887,40933924,89494469,83269557,59784896,5388481,78861134,67316075,35394356,6351548,29116732,14943837,10209545,8649148,2525268,87621407,12262393,12079734,12965761,81985784,78613627,38981606,22227683,42908201,63362460,64184058,54749427,13093792,48150362,91691605,93431862,80744121,73481154,80186010,11232355,30037118,17257342,62893810,66961194,1596508,36733451,27143874,28720123,32134638,38988538,64973287,1580833,38628859,92133240,29996433,56980148,19612721,15595052,76446915,41113025,20277376,62113340,77153811,34358408,98371278,19700943,85310252,39432962,59724555,1003028,33296432,60303688,96891787,95816395,57062206,18106132,72717433,76922029,69436288,64379430,58369990,84916669,44436472,64319467,49684352,17643265,88413677,42596828,65737274,65472618,76066541,87835759,84462118,83980492,78009994,92870717,15146890,73779005,28183605,89172051,81661951,92868896,99050989,71218746,85360035,12766474,12493482,35195612,20137754,67310848,39396763,7409792,53461122,67987302,67105242,51858306,
4192696,96352326,61173621,34566435,97567736,44178886,35283277,95824983,34710660,23118924,30314994,65260293,92755808,66712593,97623219,63060238,79979666,80908502,84327329,69572169,98266377,95362816,59392529,5285665,69884162,37195861,89312388,50720316,45195443,20721928,40044918,9327502,86188410,75434695,45702014,75043725,21672573,9482987,72631243,50078320,76909279,38695361,52566270,24326617,11460577,32013448,13650422,95943058,42679662,79785958,77542832,35209994,4756629,40921545,8814959,72429240,5284653,4058065,78663366,3536537,96872283,16146511,80651316,17045014,16480084,101201018,54266211,63749102,74131780,12600382,16474916,79858629,37343995,5352328,43863925,7080743,984114,93449450,67045745,12235475,60434101,24040093,57630503,73040500,20315854,81563416,86937530,65953423,42921475,55623480,68401546,75582395,86170989,68468459,31887905,21390858,68881649,4376658,40542825,31764353,54100561,34193084,73176465,97396380,218704,41392891,89529919,77456781,68870276,2863439,22855882,27012717,81109178,68535320,69000994,66413481,46534755,64752646,27132350,87473172,20455229,86605184,71407486,10560119,33034646,41089128,79444933,66499018,23297235,77372241,95621257,96890582,17390179,209710,83812099,9400127,10851853,39246582,82896870,66457138,13241004,66765023,31987274,84834865,3134241,88875132,5628232,33314479,15001940,5298175,29088922,17706537,16556849,85359414,98818516,12451640,38538445,98336111,90642597,4130270,12423762,26082117,28884172,49003308,51355346,50354944,40371092,14882493,28770951,9024367,863795,98555327,77491079,2196767,11549357,24291651,88283496,59019082,12800777,19012345,91482773,5818798,101201003,30190809,423705,85651167,47030842,92693205,923596,73428497,72370114,47687766,11662742,27004302,90019393,72056560,69243722,91731841,45662855,35622739,27126980,43114901,54620698,64734090,69140098,26254876,91798373,19041767,72305034,99000107,69247929,98147766,91438994,27827903,68450517,94622638,56511382,24432029,19182751,67483216,52222372,77895328,54635862,77936940,21887179,59965151,61103515,64804316,95265975,41762634,58185394,73698349,97017120,58831685,80280944,8471389,47606319,82116191,17241941,38445524,76543119,20032555,8226374,29216967,84620194,69811710,92784374,16693254,36227804,66399675,73551138,39905966,19959742,17241370,63942761,30334522,29888389,59789370,43175027,90582719,52502677,41470137,25924653,31247589,57731460,4253484,2067935,78868776,77642288,50893987,899287,78658564,66707058,18960169,85306040,12755462,82324312,63665875,25259669,53493204,10236520,21155323,56105047,39695323,19667590,62476815,2948263,59911557,15367030,55010259,28565527,76203291,81344070,52323207,7526150,42868711,24073068,52467217,10992251,13944422,13676474,35866404,32907538,2906250,40937767,11448373,22134079,25262697,99877698,17393207,30213599,37101832,46955770,63695531,58657303,24317029,11813953,55691901,27796375,92736188,13429800,41172955,13090893,53829412,58314394,17243896,56198785,53754104,99581584,73544866,10755153,9633505,33460840,89272878,47879985,75209824,6990577,54629413,98301564,45883110,41788781,38975369,61027400,24639891,63748694,78362751,28066831,17201174,94535485,5640330,68473226,73941492,90238142,68815132,56585883,76812113,91932350,27927359,54415063,66386380,39392286,75064463,31987203,85399281,5434080,31281980,34761062,90365482,74968065,54493213,47025270,66337215,60316373,87255382,56921677,96704018,82315772,82293134,19310321,45705025,65848811,89774530,34143852,18548966,61132951,50491121,52370835,1833916,64501875,78033100,41639001,54579801,71459017,76184692,43730887,70124586,40410110,37742478,69669405,75830094,43530283,46821314,90788081,73018302,37869028,22587018,2118022,2671330,40348946,20351153,22200403,21297224,95929069,99328137,82777208,28762303,24019092,97024987,56347375,32485518,53303460,56673112,62953041,55273560,3775068,84173492,82773292,47754278,8581705,99177923,51566770,54320860,74823665,101201014,94730900,21351206,89423971,62034800,76520646,4941482,97923414,35052053,28450915,3056267,38450736,52601736,53274132,41916534,73405179,4042268,22657402,3137279,43543777,23850421,44364207,96235275,84673417,96287685,14851496,83725008,43697559,40894584,51916032,94773007,53535814,42851643,51855378,43436049,78922939,59546797,11012887,71106375,23927545,59312550,52768103,51934376,20065259,94656263,17444133,68928540,12829151,95789089,39118197,24150026,6276588,3846170,70271583,31149212,48048590,66752837,54878498,25926710,80441106,63542003,20541432,88979991,83986578,64788463,15767889,75901113,39037517,80367387,6320631,32314730,41201555,54520292,14309486,19642889,176392,74576482,80839052,95204084,30936186,95090813,1184620,67724379,67050396,93302695,76512652,82642348,56514812,60802233,97590747,90147755,16188701,38480590,84900597,79418153,11125718,46272804,95993388,70156946,80275707,
35911108,41741922,30303854,11834972,38492752,46404281,89609515,52786469,67468948,7127502,87010442,15327215,75116619,49721904,25280974,62543393,98225108,47226949,49922726,55444629,16312943,82128978,89617515,54766667,27407330,68812773,52339733,23331400,4611269,61692648,55210709,90790253,40666140,94183877,35514096,99510761,81618817,40320754,45871897,68762510,48596760,11439455,14152693,35618217,50546208,11091375,92746535,22624373,10071151,96384007,42940404,85136114,54563536,23782705,60999392,45674286,96938777,94664694,79182538,79870141,34680482,48252330,11868731,26016357,52404456,77848740,22530212,10239627,23220863,6061630,46474915,68024506,31629407,94418111,43930492,43857222,80304126,66078354,47929865,19489718,15983048,95833645,26655293,93013676,40695128,21524779,84055227,17214465,79629370,68395509,94784213,645794,32918479,60102563,21593977,14255590,72657739,13723605,43714890,95492061,71277255,33945211,91953000,99885917,21057444,44287299,53573406,22512406,10189126,75499502,24530661,34160055,75195825,80965043,36521307,17946349,89743495,52354896,53577438,27182739,16360142,94538053,4417407,94973028,20368763,31533704,44026393,15335853,67922702,94667532,7359741,58843503,18551923,90444325,36849933,63056220,81823360,47731128,93715853,84754430,3715284,2137678,75733063,39648965,86569121,49905576,34198387,24435369,21767650,282886,58471134,22076135,37792478,33256280,32472237,19476824,26638543,92826944,62327910,47558785,5130393,72427512,61845881,24419823,53666449,46864967,63259351,101201006,38572779,12836042,65549080,82199284,22837504,29054481,71340250,45159319,4732017,7225792,637216,45909477,16366944,71717923,43573231,92720564,55119278,75775867,84592800,57839750,78394032,86767655,82108372,99937011,4848423,9837195,54098121,18108166,47060154,68516705,74591968,83011278,15025844,15613529,50457953,80959027,55424270,28570310,54965929,43709490,97518132,70948327,27762803,29942771,33866130,70083723,80555116,84905691,51254980,96653775,25654671,55099248,24644634,62405028,28297833,60666820,89463537,72090076,16587243,816427,91554542,85840608,19594506,50930991,4335645,88724332,78402798,20295753,81306586,66569334,24701235,11987744,95027497,4041838,92125819,30575681,47120245,57690191,42472002,19680539,13391185,88923963,18426196,59057152,5361816,73359475,34242278,92887027,91011603,48783998,92065772,36010310,12953226,52077741,98806751,90464188,45121025,3606209,66927994,95990456,43268675,14531242,71071546,57835716,2311603,59644958,39229392,58071123,13760677,84530620,71408082,6075801,85346853,86401517,68670547,73398797,21263083,39091951,75375465,15936370,42035044,73776643,71930383,4807253,31292357,71578874,7563579,67696066,72708264,37745740,44481227,9000988,92644052,21949879,64207696,55997110,88358139,92170894,10731333,47075569,71863024,44364077,15978426,26270847,42562690,40318957,65195959,93892436,29169993,220414,73511233,7714344,79967395,99792080,62393472,71181155,34961968,7576264,43191636,74852097,30312361,12958919,98881931,2618045,64145892,1362589,97639441,89132148,65367484,43147039,69846323,16020923,20700531,26185991,83682209,97526666,43716289,6903857,89547299,68075840,50621530,31440046,31600513,22011689,52792430,31118030,549481,64025981,8129306,2316186,75917088,78527720,82213171,21414674,89770167,10071456,16684346,9798352,29417188,65471349,58453942,77590412,48461764,77044671,86605515,71411377,25652259,73783043,6256844,46572756,74875003,84177693,70856343,6483224,56524813,37829468,77558536,10194329,73977033,5929801,96345188,60508057,51814159,6552938,60950180,31314549,87321742,83236601,53251824,9190563,44680819,255998,6337436,25236056,43378076,18000338,91020571,79387392,10028593,23421244,4550066,65570596,8372133,86445415,72318602,81354330,14886469,53485634,67300516,30494314,68769900,2851070,70821187,20210570,80102359,60606759,89594399,43002864,16909657,14878871,56343672,50485594,85138716,70630741,65734501,91222209,96938986,46502744,3072077,87347365,31709826,12469386,62403074,83957459,11845050,132308,72498838,14812659,71971554,38601126,44203504,36187051,30860696,51987571,91939608,67127799,77189532,5969957,68464358,44956694,96385345,2752099,23087070,1557341,46303688,54040221,16509093,70791313,37953640,24919805,24611934,91864689,63193879,37265642,30914564,44877690,15130912,67972302,20618081,89662401,56003780,13173832,44161893,93124273,64926005,68989981,14344682,73648243,64538655,65056481,2273734,26057276,86466163,75878039,99668578,13851202,63274863,1050186,38667773,96223501,82361809,19139516,56746202,97000273,64550682,80529459,69155991,12152769,71746462,42071342,20345391,80885324,24062258,97064649,70180284,6579928,23401839,85448931,42029847,43359262,71829750,82466274,77723643,52551211,30328508,95401059,57827484,9603356,27869883,20939559,
10163855,77312273,15939448,98126725,98162021,87303357,95956346,82085619,49776811,66815913,39817919,92200612,4148264,35818851,62038047,94801854,99423156,41562624,2584136,14771222,3603242,65422840,10449150,90303176,73665146,62950604,31059809,71015787,15947754,73001017,29021114,9791914,32476603,52843699,59707204,57019473,89362180,88901771,88232397,73752131,65338781,46363422,27655513,62782218,86652646,5265750,67750322,10202894,64306248,30532390,26077387,37351133,78636495,40200834,29802344,84290642,3070049,15893860,60228941,45985838,28966434,14763299,57617178,40384720,62895219,49218300,15734813,31242786,44335251,36119641,44308317,31553716,70655556,84569017,86174055,69550259,53054833,50482813,23792058,17328157,16947147,85034450,80559548,93966624,73061465,13522325,14037717,26517393,80770678,67957315,19307353,86396750,49885567,13890468,88123329,65193366,50155385,67436768,45484331,56818977,20424878,80637190,94096018,41091257,20584712,24610207,44273680,64726269,38331564,8875971,91110378,70668285,34244455,37799519,63184227,15381421,59228631,27036706,86613346,44818,23220533,15458892,49964567,98049038,44729197,2396042,53116300,26722601,35618486,22617205,72269672,31812496,89571015,29013526,50032342,27415516,13002461,41006930,74715061,23535429,13521194,30106950,99861526,16428514,16719140,423585,10321588,86804246,8091563,85374678,5220687,41628550,5182107,41307269,89091772,82112494,78391364,56727340,90361010,34496660,44072894,69610326,31259606,40473581,79972330,20001443,56495147,11682713,62434031,70204022,49919798,12927849,36687247,11234702,44073668,3170832,79757784,64892035,86039057,18444902,73956664,572850,84847656,42822433,79210531,732302,41589166,97036149,24557335,63308047,56681873,35975813,52367652,28573958,38730226,71107816,45005708,54706054,97093037,93346024,4404099,26704411,94845226,84080939,82489470,68049471,83764996,84926738,8978197,99315585,36704180,32541773,76305638,27782503,31904181,95519486,29491031,10262698,87557188,78243409,18180762,38479725,65475294,51838385,33977496,78423643,12332865,76075810,16223761,70797118,48049769,49791927,64730881,82496097,74578720,19891131,52083044,56308388,18063928,68860936,11375683,69572024,59383041,79875176,42386471,15270885,64116319,16392422,65458948,53623827,71283180,1826676,58132856,94283662,34072799,13821299,52286175,75416738,55428242,45803070,88078306,82738277,91812341,28201945,49027020,28868394,45221020,87209160,19096726,77827521,32912040,33184167,86361354,61283655,91505214,59604521,20474741,45042329,96163807,61538782,34853266,47459126,37313348,70050374,88132637,24025620,40225398,94119974,72842870,2333365,83235263,11637481,72491806,60806437,7152333,33551032,30464153,92084010,58911105,1784619,8512558,33725002,51638941,99348756,3026686,80485722,26495087,88728507,1371589,46571052,61777313,77135531,29280200,66401502,29302858,41802073,69512157,31772684,22499463,36278828,36745317,9350312,10642488,43014054,79928401,93130021,94042337,62379337,56043447,54185227,27780618,52575195,76459806,17415895,93151201,14898066,75311421,13220032,168917,5237827,47228077,74064212,40619741,10712320,84313685,87836938,96300057,13945283,52589809,42994702,83286340,19771459,47504322,75953262,5438492,43797906,66073051,55014050,93343894,2483611,88205593,88392300,81896771,72053645,23147658,91996584,15090429,99234526,1571945,48654323,12213463,49930315,11067666,31374201,92391084,99865167,85682655,80538728,59297550,25484449,12299841,53540729,71007216,87796900,57405307,18430390,87523462,72714461,30525991,78010363,17720747,21744288,36304921,56369281,44928016,15079028,51043243,88438982,73216412,85754829,71315423,17649753,3204467,30299166,11722335,47111934,69750536,58996430,62651957,23115241,50604950,26993374,17086528,5998840,77330185,86062400,43138260,7850740,86559484,65622692,29380133,10315429,94215860,71280811,13839120,64749612,53090623,57511992,65247798,92246806,28630501,58981727,91420254,25244515,64500000,40460013,29951323,84388461,12171659,93816465,35998832,16268841,31525442,43642620,17259470,81616639,14575467,88472456,78872731,77150143,31755044,36099130,68258355,4647954,23720856,7459013,40941889,2648201,95886782,18865703,76080032,29071332,39964797,21915012,34109611,31919988,17881964,22804644,28798938,80532587,17412721,26050548,12015000,10040267,86520461,28373620,83743222,86943389,13529466,41544074,54541900,45655875,59036972,81019803,37260946,78734254,13857930,12948099,70913714,67556500,80516007,46354113,49407319,89194103,44155002,52639377}
levels[5]={9091064,87148330,46384672,25460258,27882993,96795312,95166228,40160226,49681811,70676581,47126872,82012319,5399521,74388798,94454495,56421754,70950698,79176962,12408276,1287123,45450218,10852583,31456110,46169154,3121655,57946551,70095154,70456282,85103922,91711547,16475472,33837653,49139666,84903021,19636995,82482194,3859859,19153634,76052811,100441001,59380081,75498415,47077697,35595518,48228390,18036057,76925842,48768179,51644030,52296675,57579381,42338879,84976088,30411385,56713174,70479321,82419869,81263643,3084730,56161953,22712877,85080444,21250202,41039846,50939127,91862578,95727991,15464375,37780349,22790910,75892194,3111207,545781,61465001,9929398,7845138,55586621,13482075,52846880,52495649,99427357,73285669,33964637,91300233,47611119,3113836,92731385,49513164,9551692,84058253,13298352,57477163,26273196,72064891,66235877,80071763,78084378,18514525,44509529,47219274,81197327,7631534,36319131,3366982,26435595,16114248,14225239,72959823,66309175,85684223,68319538,94515289,76359406,29981921,90953320,43385557,47395382,76891401,88033975,60800381,24943456,37706769,77506119,86137485,27565379,26593852,68989420,286392,45298492,38148100,40251688,65398390,63364266,98558751,94677445,53325667,29143726,99937842,65536818,11522979,29515122,7628844,2896663,60992364,67173574,94798725,87911394,20785975,85121942,12744567,6659193,100441010,10300821,57031794,66970002,94119480,13183454,39317553,56832966,20145685,23672629,21313376,73964868,29669359,69840739,50449881,19333131,39139935,36076683,2609443,71612253,58600555,62070231,58069384,34876719,26211048,23998625,20563387,90126061}
levels[6]={23309606,50532786,81418467,6637331,25343280,33854624,60242223,72656408,89194033,99365553,39357122,43791861,53008933,61370518,63014935,77363314,77841719,53982768,60953118,41002238,45885288,52824910,12298909,17573739,11426487,29884951,85967160,84341431,95218695,77585513,95888876,27354732,11020863,9391354,9628664,53257892,55818463,59496924,82260502,6917479,29303524,57666212,85718645,29596581,96055137,7541475,9596126,57902462,4472318,28865322,37955049,23116808,45425051,73891874,11074235,34456146,89810518,46809548,81275309,74150658,46237548,56099748,77672444,30118701,29491334,31178212,32349062,34966096,77527210,12289247,30603688,42006475,58143852,8820526,18724123,34294855,22138839,76352503,80513550,52963531,88989706,51085303,44913552,46104361,60764609,98875863,83107873,17871506,55349196,73602965,27408609,90027012,11449436,82579942,99733359,91800273,28355718,48486809,78835747,55787576,11508758,55688914,82971335,35330871,21496848,56350972,11877465,71406430,95825679,61472381,45222299,4388680,26674724,77235086,3629090,81260679,48832775,7243511,9785661,86274272,24232799,50907446,11825276,76614340,32775808,46640168,99724761,10920352,57594700,21947653,48156348,61204971,59531356,69601012,98927491,10365322,92422871,16304628,2111707,85545073,33129626,86805855,13722870,28143384,1769875,22160245,35809262,47737087,50282757,73391962,93860227,86239173,45445571,49868263,33202303,41517968,52031567,46396218,464362,85908279,11765832,84988419,74009824,12678870,74936480,7391448,66818682,34235530,33413279,46132282,19974580,12501230,59969392,64635042,601193,57288064,53950487,5309481,3429238,76547525,35252119,32995007,63465535,78229193,42566602,3779493,50321796,65892310,21368273,73079836,38904695,97007933,21187631,60634565,77313225,49816630,46956301,64880894,8690387,41924516,70634245,12172567,63410069,91575236,84040113,21521304,30128445,96864105,64554883,79559912,14152862,38495396,92661479,75083197,64689404,71100270,27069566,18511599,32302078,27552504,35103106,61248471,93713837,6284176,27337596,10000030,99666430,45935145,10443957,44505297,69757518,45742626,57707471}
levels[7]={39761418,97452817,3167573,28674152,76029419,41456841,19221310,68007326,53804307,3611830,20849090,29424328,30126992,65192027,73879377,94392192,41782653,29587993,83303851,87742943,40732515,76862289,71564150,39711336,10497636,56619314,78193831,3428069,25955164,30676200,26400609,59793705,44689688,92536468,48964966,82385847,96546575,59712426,15744417,98434877,90835938,29436665,68304193,40221691,32909498,62340868,89399912,64382839,4162088,78661338,22916418,8910971,98520301,93709215,39188539,85753549,54537489,48745395,42713844,25607552,53318263,51611041,13846680,50957346,59235795,12624008,86229493,86442081,39000945,90411554,34614289,23431858,36016907,5560911,94703021,4055337,70333910,78534861,31986288,96227613,22211622,95568112,50263751,88106656,23851033,66425726,61757117,4810828,10804018,47963370,24731391,60258960,37061511,21140872,82956492,15989522,37057012,43892408,53262004,10796448,11502550,37491810,64655485,81566151,93729065,50123605,72926163,48424886,10383554,33206889,13756293,12307878,62111090,10248389,8963089,18013090,20374351,59771339,6568731,80086070,36407615,89310929,36556781,9709452,43202238,4779823,16051717,23338098,81983656,82570174,23874409,10755984,32646477,40509732,4103668,67797569,13995824,63533837,82044279,90036274,87837090,22858242,37192109,65749035,24070330,63731062,69031175,82197831,93353691,28240337,33698022,73580471,45379225,40529384,9634146,2403771,68084557,42810973,98506199,80108118,4179255,25862681,73104892,68431965,72924435,50793215,9839115,33158448,6387204,30095833,41147577,45627618,86238081,95685352,98452268,60517697,92918648,16691074,95239444,44405066,47132793,74371660,67630394,78144171,16037007,92015800,57450198,22110647,85004150,91949988,80117527,38694052,96157835,96471335,51822687,53701457,85551711,60195675,83827392,82308875,10389142}
levels[8]={24643913,55735315,48579379,85605684,80870883,23846921,46412900,83104731,5141117,81497285,19959563,57774843,4538826,16898077,33545259,38517737,48452496,65026212,72989439,73304257,82301904,93717133,27268998,15894048,22056710,52240819,72880377,32543380,55885348,1966438,44009443,91073013,99456344,7574904,57610714,47198668,60349525,85314178,81146288,2347656,63737050,36405256,75745607,53842431,60681103,11819616,5645210,33655493,47297616,14509651,76728962,82791472,4918855,39185163,82556058,80019195,84565800,85800949,10604644,35699,55591586,38775407,61089209,18558867,57662975,23015896,18891691,84845628,10026986,15033525,35614780,62002838,35803249,63487632,19441018,58844135,94689206,15845914,33331231,36322312,62849088,96823189,8085950,27015862,18175965,34022290,45467446,57043986,65033975,81914447,96733134,91337277,71197066,34695290,24226942,38107923,47330808,61505339,90488465,92719314,55920742,59900655,31829185,62098216,87263576,91434602,43413875,90583279,13694209,45796834,95679145,29601381,81555617,98898163,86346363,8170654,79185500,93920420,89019964,31042659,17286057,97811903,55410871,86327225,101207092,7987191,52900000,54484652,70551291,24175232,20654247,34093683,25857246,10441498,16313112,29348048,39618799,71203602,97642679,25415052,91668401,62420419,19025379,72426662,46427957,25726386,99628747,40352445,72566043,86676862,30086349,21225115,22900219,11443677,65815684,86165817,1561110,84243274,8463720,37818794,38811586,41721210,58071334,84330567,101208037,92892239,85059922,91034681,1516510,36256625,46174776,72378329,88305705,33026283,13735899,8198620,58293343,75380687,5829717,35035985,98502113,49820233,83121692,91998119,20366274,97165977,4591250,16006416,25793414,6602300,50237654,28016193,74157028,43227,22070401,41209827,37261776,43387895,83866861,324483,96897184,45716579,9603252,69946549,10526791,60493189,29095552,73167098,87751584,24915933,72272462,72578374,60461804,1906812,6855503,34848821,80889750,40636712,44373896,35877582,97300502,87182127,34408491,42291297,81020646,5772618,39823987,41659072,96029574,3040496,27548199,58074177,50954680,80666118,87451661,95453143,72896720,9464441,39765958,52145422,5041348,58672736,72444406,25165047,72444406,54048462,18239909,65187687,45420955,74586817,5614808,33236860,10140443,49389523,76774528,18843291,9012916,60992105,77855162,23693634,75779210,69248256,45037489,70780151,25132288,88643579,69514125,63261835,61272280,24634594,821049,14307929,30983281,44508095,59123194,70771599,83994433,13076804,31385077,44094981,15248594,83755611,29325276,90587641,67904682,73445448,39030163,31801517,48348921,18897163,89516305,48995978,2978414,73082255,10666000,63767246,77799846,88177324,3292267,698785,64182380,75433814,98986900,33779875,30741334,1639384,11132674,93854893,8165596,10406322,10678778,88120966,10406322}
levels[9]={27134209,88619463,81743801,20073910,37495766,44874522,64063868,22091647,5206415,40061558,63633694,94160895,35183584,43363035,84257883,30539496,40998517,13903402,9794980,26866984,82321037,84673574,32965616,33776734,8836329,52068432,75771170,42932862,6150044,37663536,45349196,11464648,28226490,70219023,79864860,75748977,87804747,88753594,95793022,17032740,90307498,78512663,49352945,14529511,41232647,28497830,59353647,39512984,18386170,82135803,15661378,10817524,78778375,75286621,79194594,61398234,74659582,80453041,24221808,9753964,13455674,52352005,95526884,50278554,77656797,2743001,3486020,52687916,66698383,80040886,40908371,27315304,87188910,9348522,75676192,12632096,68396121,58820923,88754763,6165656,69170557,2530830,97584719,3685372,95113856,1992816,9940036,6906306,9349094,28981598,97403510,2665273}
levels[10]={79850798,46033517,58054262,8967776,5861892,10000000,10000090,32491822,33015627,62180201,69831560,69890967,85991529,79407975,18940556,97565997,51402908,27279764,59464593,84425220,93368494,30270176,36974120,43218406,53184342,53212882,6022371,88264979,13836592,95440947,46518210,98248208,21364070,86999951,43944080,59369430,16893370,51849482,6616912,7733560,8062132,15771991,22804410,28929131,34137269,40227329,60222213,65314286,67547370,74530899,78371393,91712985,92435533,99748883,93880808,7634581,10000022,21208154,98777036,57793869,92487128,39468724,88240999,66729231,59913418,96915510,78316184,88926295,13518809,72664875,86346643,51788412,12652643,95463814,1546123,74889525,39915560,6182103,24550676,31817415,75906310,58601383,33652635,19652159,51570882,59255742,41685633,39552584,56655675,90555947,42166000,46186135,76263644,2129638,71101678,29343734,69394324,40680521,74822425,76075139,13708888,18967507,85065943,87460579,93483212,8763963,67030233,21435914,7841112,27572350,16172067,36857073,72402069,22850702,30604579,59843383,9888196,48891960,88234821,67098114,89907227,96402918,24696097,63180841,80896940,51447164,73218989,63101468,92361635,93157004,40139997,61775475,8561192,21281085,18969888,54082269,90465153,96633955,39402797,6766208,59765225,74892653,84815190,89474727,39477584,86682165,47710198,17548456,84664085,494922,89544521,67508932,37910722,72309040,66523544,21858819,28346136,32559361,51543904,3814632,49032236,46593546,70636044,87676171,47017574,90162951}
levels[11]={23288411,25833572,4335427,17469113,37169670,29432356,91588074,22073844,25451652,78098950,47556396,27204311,85687952,89818984,54135423,4779091,21105106,50855622,90050480,95095116,82734805,18666161,40939228,60465049,86154370,39475024,41517789,44708154,70980824,26096328,49202331,26556950}
levels[12]={52085072,47027714,63468625,97417863,16802689,80630522,40785230,31764700,82103466,16306932,56863746,69815951,51522296,95209656,62873545,99267150,12381100,37542782,3149401,84433295,43228023,56532353,4167084,6218704,13331639,54702678,37440988,84544192,67745632,8505920,50687050,32615065,43378048,47172959,60110982,22723778,21123811,26268488,35952884,37442336,48654267,95973569,97836203,99585850,94130731,89604813,84343351,97489701,15982593,35057188,80773359,26443791,42632209,99217226,53971455,64193046,17775525,90884403,62541668,90448279,84025439,93039339,23187256,89477759}



function s.op(e,tp,eg,ep,ev,re,r,rp)
	if e:GetLabel()==0 then
		local e1=Effect.CreateEffect(e:GetHandler())
		e1:SetType(EFFECT_TYPE_FIELD+EFFECT_TYPE_CONTINUOUS)
		e1:SetCode(EVENT_PREDRAW)
		e1:SetCondition(s.flipcon)
        e1:SetCountLimit(1)
		e1:SetOperation(s.flipop)
		Duel.RegisterEffect(e1,tp)

        local e2=Effect.CreateEffect(e:GetHandler())
		e2:SetType(EFFECT_TYPE_FIELD+EFFECT_TYPE_CONTINUOUS)
		e2:SetCode(EVENT_SPSUMMON_SUCCESS)
		e2:SetCondition(s.repcon)
		e2:SetOperation(s.repop)
		Duel.RegisterEffect(e2,tp)


        local e3=Effect.CreateEffect(e:GetHandler())
        e3:SetType(EFFECT_TYPE_FIELD+EFFECT_TYPE_CONTINUOUS)
        e3:SetCode(EVENT_ADJUST)
        e3:SetCondition(s.adcon)
        e3:SetOperation(s.adop)
        Duel.RegisterEffect(e3,tp)



	end
	e:SetLabel(1)
end


function s.adbackfilter(c)
    return c:IsOriginalCode(id+1)
end

function s.adcon(e,tp,eg,ep,ev,re,r,rp)
	return Duel.IsExistingMatchingCard(s.adbackfilter, 0, LOCATION_ALL-LOCATION_OVERLAY, LOCATION_ALL-LOCATION_OVERLAY, 1, nil)
end
function s.adop(e,tp,eg,ep,ev,re,r,rp)
    local g=Duel.GetMatchingGroup(s.adbackfilter, 0, LOCATION_ALL-LOCATION_OVERLAY, LOCATION_ALL-LOCATION_OVERLAY, nil)
    if g then
        for tc in g:Iter() do
                Duel.RemoveCards(tc)
        end
    end
end

function s.validreplacefilter(c)
    return c:IsType(TYPE_TOKEN) and c:HasLevel() and (c:IsLevelAbove(1) and c:IsLevelBelow(12))
end

function s.flipcon(e,tp,eg,ep,ev,re,r,rp)
	return Duel.GetCurrentChain()==0 and Duel.GetTurnCount()==1
end

function s.repcon(e,tp,eg,ep,ev,re,r,rp)
	return eg:IsExists(s.validreplacefilter, 1, nil, e) and rp==tp
end

function s.repop(e,tp,eg,ep,ev,re,r,rp)
	local c=e:GetHandler()
    Duel.Hint(HINT_CARD,tp,id)
    local g=eg:Filter(s.validreplacefilter, nil)
    for tc in g:Iter() do
        local lv=tc:GetLevel()
        local selectgroup={}
        local num1=Duel.GetRandomNumber(1,#levels[lv])
        local num2=Duel.GetRandomNumber(1,#levels[lv])
        while num2==num1 do
            num2=Duel.GetRandomNumber(1,#levels[lv])
        end
        local num3=Duel.GetRandomNumber(1,#levels[lv])
        while num3==num2 or num3==num1 do
            num3=Duel.GetRandomNumber(1,#levels[lv])
        end

        selectgroup={levels[lv][num1],levels[lv][num2],levels[lv][num3]}

        local codechoice=Duel.SelectCardsFromCodes(tp,1,1,false,false,selectgroup)
        tc:Recreate(codechoice,nil,nil,nil,nil,nil,nil,nil,nil,nil,nil,nil,true)
        if tc:IsType(TYPE_SYNCHRO) then
            Duel.RaiseEvent(tc,EVENT_SPSUMMON_SUCCESS,e,REASON_EFFECT,tp,tc:GetControler(),SUMMON_TYPE_SYNCHRO)
            Duel.RaiseSingleEvent(tc,EVENT_SPSUMMON_SUCCESS,e,REASON_EFFECT,tp,tc:GetControler(),SUMMON_TYPE_SYNCHRO)
            tc:CompleteProcedure()
    
        elseif tc:IsType(TYPE_FUSION) then
            Duel.RaiseEvent(tc,EVENT_SPSUMMON_SUCCESS,e,REASON_EFFECT,tp,tc:GetControler(),SUMMON_TYPE_FUSION)
            Duel.RaiseSingleEvent(tc,EVENT_SPSUMMON_SUCCESS,e,REASON_EFFECT,tp,tc:GetControler(),SUMMON_TYPE_FUSION)
            tc:CompleteProcedure()
    
        elseif tc:IsType(TYPE_XYZ) then

            local mat1=Duel.CreateToken(tp, id+1)
            Duel.SendtoGrave(mat1, REASON_RULE)
            Duel.Overlay(tc,mat1)
    
            local mat2=Duel.CreateToken(tp, id+1)
            Duel.SendtoGrave(mat2, REASON_RULE)
            Duel.Overlay(tc,mat2)

            
            Duel.RaiseEvent(tc,EVENT_SPSUMMON_SUCCESS,e,REASON_EFFECT,tp,tc:GetControler(),SUMMON_TYPE_XYZ)
            Duel.RaiseSingleEvent(tc,EVENT_SPSUMMON_SUCCESS,e,REASON_EFFECT,tp,tc:GetControler(),SUMMON_TYPE_XYZ)
            tc:CompleteProcedure()
    
        elseif tc:IsType(TYPE_RITUAL) then
            Duel.RaiseEvent(tc,EVENT_SPSUMMON_SUCCESS,e,REASON_EFFECT,tp,tc:GetControler(),SUMMON_TYPE_RITUAL)
            Duel.RaiseSingleEvent(tc,EVENT_SPSUMMON_SUCCESS,e,REASON_EFFECT,tp,tc:GetControler(),SUMMON_TYPE_RITUAL)
            tc:CompleteProcedure()
    
        else
            Duel.RaiseEvent(tc,EVENT_SPSUMMON_SUCCESS,e,REASON_EFFECT,tp,tc:GetControler(),SUMMON_TYPE_SPECIAL)
            Duel.RaiseSingleEvent(tc,EVENT_SPSUMMON_SUCCESS,e,REASON_EFFECT,tp,tc:GetControler(),SUMMON_TYPE_SPECIAL)
            tc:CompleteProcedure()
    
        end
    end
end

function s.flipop(e,tp,eg,ep,ev,re,r,rp)
	Duel.Hint(HINT_SKILL_FLIP,tp,id|(1<<32))
	Duel.Hint(HINT_CARD,tp,id)
end

